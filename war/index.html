<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- The HTML 4.01 Transitional DOCTYPE declaration-->
<!-- above set at the top of the file will set     -->
<!-- the browser's rendering engine into           -->
<!-- "Quirks Mode". Replacing this declaration     -->
<!-- with a "Standards Mode" doctype is supported, -->
<!-- but may lead to some differences in layout.   -->

<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Spinning Wellness</title>
<script type="text/javascript"
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>

</head>

<body>
	<script language="javascript" type="text/javascript">
		$(document).ready(function() {
			alert("Welcome to Spinning Wellness!");
			
			$.ajax({
				type: "GET",
				url: "resources/l2wuser/getallusers",
				contentType: "application/json; charset=utf-8",
				dataType: "json",
				success: function(response) {
					for (var i = 0; i < response.user.length; i++) {
						var aUsername = response.user[i].name;
						var o = new Option(aUsername, aUsername);
						/// jquerify the DOM object 'o' so we can use the html method
						$(o).html(aUsername);
						$("#userList").append(o);
					}
					
					$("#userList").change(function(){
					    var user = $("#userList").val() ;
					    
					    showmyupcomingrides(user);
					});
				
			},
			failure: function(errMsg) {
				alert("in error!");
				$("#errMessage").text(errMsg);
			}
		});
});
		
function showmyupcomingrides(user){
	var dateVal = new Date().getTime();
	alert(dateVal);
	$.ajax({
		type: "GET",
		url: "resources/l2wride/myupcomingrides/" + user + "/" + dateVal,
		contentType: "application/json; charset=utf-8",
		dataType: "json",
		success: function(response) {
			
			for (var i = 0; i < response.ride.length; i++) {
				var aride = response.ride[i].name;
				var o = new Option(aride, aride);
				/// jquerify the DOM object 'o' so we can use the html method
				$(o).html(aride);
				$("#rideList").append(o);
			}
			
			$("#rideList").change(function(){
			    var ride = $("#rideList").val() ;
			    
			    getRideDetails(ride,user);
			});
		
	},
	failure: function(errMsg) {
		alert("in error!");
		$("#errMessage").text(errMsg);
	}
});	
}	
	
function getRideDetails(ride,user){
	alert("get ride details");
}
</script>
</head>
<body background="bckgd.png">
	<form id="form1" runat="server">
		<div>
			Select a user:
			<select id="userList">
				
			</select>
			Rides:
			<select id="rideList">
				
			</select>
			<div id="errMessage"></div>

		</div>
	</form>
</body>


</html>
